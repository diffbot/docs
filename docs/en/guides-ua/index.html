<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Using Custom User Agents · Docs Suite</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Diffbot supports passing along custom User Agent strings when processing websites. This is very useful when a website wants to whitelist a customer, but only that customer, blocking all other bots and even all other Diffbot customers. This guide shows you how to modify a Diffbot User Agent string."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Using Custom User Agents · Docs Suite"/><meta property="og:type" content="website"/><meta property="og:url" content="https://diffbot.github.io/"/><meta property="og:description" content="Diffbot supports passing along custom User Agent strings when processing websites. This is very useful when a website wants to whitelist a customer, but only that customer, blocking all other bots and even all other Diffbot customers. This guide shows you how to modify a Diffbot User Agent string."/><meta property="og:image" content="https://diffbot.github.io/img/diagram.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://diffbot.github.io/img/diagram.svg"/><link rel="shortcut icon" href="/img/diffbot-head.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/app.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/diffbot_white.svg" alt="Docs Suite"/><h2 class="headerTitleWithLogo">Docs Suite</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/en/error-intro" target="_self">Debugging</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/diffbot/docs/edit/master/docs/guides-ua.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Using Custom User Agents</h1></header><article><div><span><p>When a website becomes very popular, it can draw the attention of many scraping bots from around the web. Diffbot is one such bot. A site being swarmed by such bots may opt to ban automated visitors altogether which isn't ideal for Diffbot's customers. In those cases, it is best to speak with the website's owners, assure them of noble intentions, and get them to whitelist a custom User-Agent string so that Diffbot can pass through.</p>
<p>But what if they don't want all Diffbot customers to crawl them, only <em>you</em>, their favorite customer? You can get as specific as you want with User-Agents.</p>
<h2><a class="anchor" aria-hidden="true" id="setting-a-custom-user-agent"></a><a href="#setting-a-custom-user-agent" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting a custom User-Agent</h2>
<p>Let's suppose that you agreed with the target website to whitelist the word &quot;pineapple&quot;. In other words, any User-Agent containing the word &quot;pineapple&quot; will be allowed through, but any User-Agent without it will be blocked by the target website entirely. How do we add &quot;pineapple&quot; to our User-Agent string permanently?</p>
<p>The following two approaches apply.</p>
<h2><a class="anchor" aria-hidden="true" id="new-dashboard"></a><a href="#new-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>New Dashboard</h2>
<p><em>Note: for this section, you need access to Diffbot's new beta dashboard. More info <a href="tutorials-new-dashboard">here</a>.</em></p>
<p>For testing purposes, let's set up a <a href="https://requestbin.com">RequestBin</a>. RequestBin allows you to inspect requests coming in so you can see which headers have been applied. We're interested in the User-Agent header. Go ahead and set up a RequestBin. Once you have your unique URL, go to the Custom API section in the new dashboard and enter the unique requestbin URL, then click Create. You should see something like this in Diffbot:</p>
<p><img src="/img/ua/01.png" alt="Requestbin as custom API"></p>
<p>And the RequestBin UI should give you the following header information:</p>
<p><img src="/img/ua/02.png" alt="Requestbin headers"></p>
<p>You'll notice we have <code>Mozilla/5.0 (compatible; Onespot-ScraperBot/1.0; +https://www.onespot.com/identifying-traffic.html)</code> as the current UA. Now let's go into the <code>Other Settings</code> tab in Diffbot's custom API UI and add a new User-Agent. Once we click Save, the rule will reload and re-issue the request towards RequestBin. That's all there is to it - the header values should show &quot;pineapple&quot; now.</p>
<p><img src="/img/ua/03.png" alt="Pineapple header"></p>
<p>Repeat the process for every domain for which you want a custom User-Agent!</p>
<h2><a class="anchor" aria-hidden="true" id="adding-user-agents-programmatically"></a><a href="#adding-user-agents-programmatically" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding User-Agents Programmatically</h2>
<p>If you'd like to modify UA programmatically and not through the UI of the new dashboard, follow the <a href="guide-backup-restore-rules">backup and restore process for rules</a> along with the guide to <a href="https://docs.diffbot.com/docs/en/api-managing-rules-programmatically">managing your Custom rules programmatically</a>. In short, you would POST the following JSON object to the <code>https://api.diffbot.com/v3/custom?token=MYTOKEN</code> endpoint:</p>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"urlPattern"</span>: <span class="hljs-string">"(http(s)?://)?(.*\\.)?endtoxq6ne57i.x.pipedream.net.*"</span>, 
    <span class="hljs-attr">"xForwardHeaders"</span>: {
        <span class="hljs-attr">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 pineapple (compatible; Onespot-ScraperBot/1.0; +https://www.onespot.com/identifying-traffic.html)"</span>
    }, 
    <span class="hljs-attr">"api"</span>: <span class="hljs-string">"/api/article"</span>, 
    <span class="hljs-attr">"testUrl"</span>: <span class="hljs-string">"https://endtoxq6ne57i.x.pipedream.net"</span>
}
</code></pre>
<p><em>Note: Remember to modify the domain of the url pattern to match your target website's!</em></p>
<p>The response to this request will contain a hash. You can later use this hash to update the rule as specified in <a href="https://docs.diffbot.com/docs/en/api-managing-rules-programmatically">managing your Custom rules programmatically</a>.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated by Bruno Skvorc</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#setting-a-custom-user-agent">Setting a custom User-Agent</a></li><li><a href="#new-dashboard">New Dashboard</a></li><li><a href="#adding-user-agents-programmatically">Adding User-Agents Programmatically</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/diffbot_white.svg" alt="Docs Suite" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/api-basics-index">Extraction</a><a href="/docs/en/cb-basics-index">Crawling</a><a href="/docs/en/kg-index">Knowledge Graph</a><a href="/docs/en/explain-gdpr">Diffbot and GDPR</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/diffbot" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/diffbot" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="/help">Help</a><a href="https://github.com/diffbot">GitHub</a></div></section><a href="https://diffbot.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/diffbot_white.svg" alt="Diffbot.com" width="170" height="45"/></a><section class="copyright">Copyright © 2024 Diffbot.com</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2c24e5e78d724e77c46ef1b720700177',
                indexName: 'diffbot',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>
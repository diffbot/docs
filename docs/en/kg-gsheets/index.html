<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Diffbot Google Sheets Add-on · Docs Suite</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="- [Installation](#installation)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Diffbot Google Sheets Add-on · Docs Suite"/><meta property="og:type" content="website"/><meta property="og:url" content="https://diffbot.github.io/"/><meta property="og:description" content="- [Installation](#installation)"/><meta property="og:image" content="https://diffbot.github.io/img/diagram.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://diffbot.github.io/img/diagram.svg"/><link rel="shortcut icon" href="/img/diffbot-head.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/app.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/diffbot_white.svg" alt="Docs Suite"/><h2 class="headerTitleWithLogo">Docs Suite</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/en/error-intro" target="_self">Debugging</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/diffbot/docs/edit/master/docs/kg-gsheets.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Diffbot Google Sheets Add-on</h1></header><article><div><span><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#field-expressions">Field Expressions</a></li>
<li><a href="#tips--tricks">Tips &amp; Tricks</a></li>
</ul>
<p>The Diffbot for Google Sheets Add-on allows you to leverage the power of the Diffbot Knowledge Graph from within Google Sheets. The Diffbot Knowledge Graph can help you quickly gather information from the public web, including information about People, Organizations, Products, Articles, and Discussions as well as enhance your existing data so that it will never be incomplete or out of date again.</p>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>To Install the Diffbot Google Sheets Add-on, visit the <a href="https://gsuite.google.com/marketplace/app/diffbot_for_sheets/457377215857">Diffbot for Sheets listing in the G Suite Marketplace</a>:</p>
<p><img src="/img/gsheets/gsheets1.png" alt="Installation page on G Suite Marketplace"></p>
<p>From here, click Install, choose the Google account that you’d like to use Diffbot from and grant Diffbot permissions. This is needed so that the Add-on can access your Google sheets spreadsheets, and connect to your Diffbot account. Diffbot will never share your personal data and the contents of your spreadsheet are never stored by Diffbot, only used to query the Knowledge Graph and fetch information from Diffbot to you.</p>
<p><img src="/img/gsheets/gsheets2.png" alt="Oauth consent screen"></p>
<p>After installation, you will see this success message.  Diffbot for Google Sheets is now installed.</p>
<p><img src="/img/gsheets/gsheets3.png" alt="Installation success"></p>
<h2><a class="anchor" aria-hidden="true" id="quick-start"></a><a href="#quick-start" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Quick Start</h2>
<p>After installation, you will now be able to access Diffbot Knowledge Graph from any Google sheet. Let’s open a <a href="http://sheets.new">blank Google Sheet</a>.</p>
<p><img src="/img/gsheets/gsheets4.png" alt="Login menu"></p>
<p>You will now need to log into Diffbot. Go to the Add-ons menu and select Diffbot for Sheets &gt; Login to Diffbot.</p>
<p>Here you will need to enter your Diffbot API token. If you do not have a token, simply register for one at <a href="https://app.diffbot.com/get-started">https://app.diffbot.com/get-started</a>. After registering for an account, you will be able to view your token on the <a href="https://app.diffbot.com/diffbot-users/my-profile/token_details/">My Profile Page</a>.</p>
<p><img src="/img/gsheets/gsheets5.png" alt="Set Diffbot Token"></p>
<p>Enter your token and hit OK. You are now ready to use Diffbot in your Google Sheet.</p>
<p>Let’s find the homepage, location, and number of employees at Diffbot.</p>
<p>Pick any cell and enter the formula</p>
<pre><code class="hljs">=DQL(&quot;type:Organization name:'Diffbot'&quot;, &quot;name,location,employees&quot;)
</code></pre>
<p><img src="/img/gsheets/gsheets6.png" alt="DQL prompt"></p>
<p>As you type &quot;DQL&quot;, you will see a help prompt come up. DQL stands for the Diffbot Query Language, and is the syntax for querying the Diffbot Knowledge Graph.  You can learn more about DQL <a href="/docs/en/dql-index">here</a>.</p>
<p>The DQL custom function takes in the DQL query, which is the way to ask the Diffbot Knowledge Graph a question, the fields, which specify which fields of those entities you would like to write into your spreadsheet cells, and an optional size, which determines how many entities will be returned.</p>
<p>So this DQL function asks the Knowledge Graph for all entities of type Organization that are named Diffbot and specifies that we want the homepage, location, and number of employees. The multiple fields are separated by commas and will be returned as a row of three cells. Multiple entities would be returned in multiple rows.</p>
<p><img src="/img/gsheets/gsheets7.png" alt="DQL result"></p>
<p>You can see the result of running that function. Congrats! You've made your first Diffbot Knowledge Graph query.  Continue reading to learn about other custom functions.</p>
<h2><a class="anchor" aria-hidden="true" id="commands"></a><a href="#commands" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Commands</h2>
<table>
<thead>
<tr><th style="text-align:left">DQL</th><th style="text-align:left">Queries the Diffbot Knowledge Graph using the Diffbot Query Language (DQL)</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>dql_query</code></td><td style="text-align:left">The DQL query. Not that single-quotes should be used in the dql query to avoid conflicting with the double quotes that surround the dql query.</td></tr>
<tr><td style="text-align:left"><code>fields</code></td><td style="text-align:left">The field of each entity to display. You can also provide multiple separated by commas. You can also use &quot;count&quot; to just return a count of entities that match the query. Optional.</td></tr>
<tr><td style="text-align:left"><code>size</code></td><td style="text-align:left">The maximum number of entities to return. Optional.</td></tr>
</tbody>
</table>
<table>
<thead>
<tr><th style="text-align:left">ENHANCE_ORGANIZATION</th><th style="text-align:left">Enhances an organization using the Diffbot Knowledge Graph</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>field</code></td><td style="text-align:left">The field of a Organization entity to return. You can also provide multiple separated by commas</td></tr>
<tr><td style="text-align:left"><code>name</code></td><td style="text-align:left">The provided name of the organization. Optional.</td></tr>
<tr><td style="text-align:left"><code>url</code></td><td style="text-align:left">The provided homepage of the organization. Optional.</td></tr>
<tr><td style="text-align:left"><code>location</code></td><td style="text-align:left">The provided location of the organization. Optional.</td></tr>
<tr><td style="text-align:left"><code>description</code></td><td style="text-align:left">A description of what the organization does. Optional.</td></tr>
</tbody>
</table>
<table>
<thead>
<tr><th style="text-align:left">ENHANCE_PERSON</th><th style="text-align:left">Enhances a person using the Diffbot Knowledge Graph</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>field</code></td><td style="text-align:left">The field of a Person entity to return. You can also provide multiple separated by commas</td></tr>
<tr><td style="text-align:left"><code>name</code></td><td style="text-align:left">The provided name of the person. Optional.</td></tr>
<tr><td style="text-align:left"><code>email</code></td><td style="text-align:left">The provided email of the person. Optional.</td></tr>
<tr><td style="text-align:left"><code>employer</code></td><td style="text-align:left">The employer of the person. Optional.</td></tr>
<tr><td style="text-align:left"><code>location</code></td><td style="text-align:left">The location of the person. Optional.</td></tr>
<tr><td style="text-align:left"><code>description</code></td><td style="text-align:left">The bio of the person. Optional.</td></tr>
</tbody>
</table>
<table>
<thead>
<tr><th style="text-align:left">NLP_SENTIMENT</th><th style="text-align:left">Analyzes sentiment of the text with Diffbot's natural language service</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>text</code></td><td style="text-align:left">The text to analyze</td></tr>
</tbody>
</table>
<table>
<thead>
<tr><th style="text-align:left">NLP_ENTITIES</th><th style="text-align:left">Returns back the entities found in the text</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>text</code></td><td style="text-align:left">The text to analyze</td></tr>
<tr><td style="text-align:left"><code>fields</code></td><td style="text-align:left">The fields of each entity to return</td></tr>
<tr><td style="text-align:left"><code>size</code></td><td style="text-align:left">The number of entities to find in the text. Optional, defaults to 1.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="field-expressions"></a><a href="#field-expressions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Field Expressions</h2>
<p>The <code>DQL()</code>, <code>ENHANCE_PERSON()</code>, <code>ENHANCE_ORGANIZATION()</code>, and <code>NLP_ENTITIES()</code> functions all take a <code>fields</code> parameter, which determine which fields of the entity to show in your spreadsheet cells.</p>
<p>In addition to requesting multiple comma-separated fields, you can also restrict which fields to return when there is a json array. For example,</p>
<pre><code class="hljs">=DQL(&quot;type:Organization name:'Home Depot'&quot;, &quot;yearlyRevenues[*].{year:2018 revenue.value}&quot;, 1)
</code></pre>
<p>Will return the revenue of Home Depot just for the year 2018.</p>
<h2><a class="anchor" aria-hidden="true" id="tips--tricks"></a><a href="#tips--tricks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tips &amp; Tricks</h2>
<p>Google Sheets limits of the number of external connections that can be made from a sheet as well as the maximum number of simultaneous connections to external services. Need to paste values if they do not change often.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated by miketung</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#installation">Installation</a></li><li><a href="#quick-start">Quick Start</a></li><li><a href="#commands">Commands</a></li><li><a href="#field-expressions">Field Expressions</a></li><li><a href="#tips--tricks">Tips &amp; Tricks</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/diffbot_white.svg" alt="Docs Suite" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/api-basics-index">Extraction</a><a href="/docs/en/cb-basics-index">Crawling</a><a href="/docs/en/kg-index">Knowledge Graph</a><a href="/docs/en/explain-gdpr">Diffbot and GDPR</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/diffbot" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/diffbot" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="/help">Help</a><a href="https://github.com/diffbot">GitHub</a></div></section><a href="https://diffbot.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/diffbot_white.svg" alt="Diffbot.com" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Diffbot.com</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2c24e5e78d724e77c46ef1b720700177',
                indexName: 'diffbot',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>